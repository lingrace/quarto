# Quarto in the command line

This module implements a command line version of the board game [Quarto](https://en.wikipedia.org/wiki/Quarto_(board_game)).

Quarto is a 2 player game where each player takes turns placing a piece on the board. There are 16 pieces, each with a unique combination of 4 properties: height, color, shape, and number of holes. For each of these properties, there are 2 options, e.g. tall or short.

The board is a square 4 by 4 grid. At the start of the game, the board is empty. Each piece can be used once and each square can be occupied once. The game is won by creating a line of 4 pieces that share a common property, e.g. all the pieces in that line are tall.

## Game Mechanics

This game has a few unique mechanics:
- There is a single set of pieces that are each a unique combination of four traits
- One player chooses a piece for the other to place
- There are many different ways to win, since the only requirement is that all pieces in a line share at least one common property

It is also interesting to note, that this game works for N = 4 because it relies on the fact that N^2 = 2^N. N = 2 is also valid, but creates a much less interesting game.

## Implementation Details
There are two significant technical decisions in this implementation.

### Representing the pieces as bit arrays
At first glance, you might want to write a Piece class, something that contains a height, color, shape, and number of holes, with each property restricted to 2 options, or perhaps a boolean for each property. Instead, I am representing each piece with an int, from 0-15. The bitwise representation of each piece, e.g. 0100, denotes the value of each property. Not only are there significant memory savings (if you wanted more, you could use a 4 bit bitarray instead of an int), initializing the full set of pieces is now trivial. This design choice also enables the second key technical decision.

### Checking win conditions with bit math
We are going to store a little bit of information about each winnable line (rows, columns, main diagonals). For each line, we are going to store the running bitwise AND and the running bitwise OR. This information doesn't take much space, and doesn't increase in size by the number of pieces placed in the line. Checking if a line is a winning line is very straightforward. If the bitwise AND contains a 1, as in, is != 0, then at least one of the bit positions is 1 in every piece in the line. If the bitwise OR contains a 0, as in, is != 15, then at least one of the bit positions is 0 in every piece in the line.

To prove this, let's take a single bit position. Let's say that amongst the pieces in this line, the values in this position are m 0's and n 1's.

| Case           | Bitwise AND | Bitwise OR |
|----------------|-------------|------------|
| m = 0, n > 0   | 1           | 1          |
| m > 0, n > 0   | 0           | 1          |
| m > 0, n = 0   | 0           | 0          |

In all possible cases, bitwise AND = 1 necessarily means that all of the pieces have a value of 1, and a bitwise OR = 0 necessarily means that all of the pieces have a value of 0. 

It generalizes that unless the total bitwise AND is 0, there is at least one of the four positions where all four pieces have a value of 1. Similarly, unless the total bitwise OR is 15, or 1111, there is at least one of the four positions where all four pieces have a value of 0.


## Implementation Notes
I wrote all of the code in the quarto package. The unit tests are generated by Cursor using Claude.

## How to Run
To setup, clone this repo and run the following command.
```
python -m venv venv
source venv/bin/activate
pip install --upgrade pip
pip install -r requirements.txt
```

To start the game, run the following:
```
python main.py
```

You will be prompted to:
1. Enter the names of both players
2. Choose your preferred piece format (binary or decimal).
3. Begin playing the game

### How to Play

The order of play is as follows:
1. Player 1 selects a piece
2. Player 2 places that piece on the board
3. Player 2 selects a piece
4. Player 1 places that piece on the board

The game continues until a player wins or the board is full.


